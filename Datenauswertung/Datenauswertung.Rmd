---
title: "Datenauswertung"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


library(tidyverse)
library(jmv)
library(ggplot2)

df <- readRDS("data.rds")

```


noch Diagramme anpassen bzgl. limits und im generellen überprüfen



to do:

* hypothesen aufschreiben und beantworten, berichten wie auf Folien vorgegeben (Unterschiedshypothesen)
* ggf Visualisierungen für Unterschiedshypothesen (boxplots?)
* berichten von Unterschiedshypothesen (Video dazu in der Youtube Playlist "WS19/20 Seminar - Forschungsmethoden 10. ANOVA" dort wird das alles soweit vorgestellt, denke auch Visualisierungen)


# Korrelationen

```{r}

# Hypothese 1: Arbeitszufriedenheit, Switch-off

#### Hypothesen "richtig reinschreiben"

## Anpassung JRH: Das sind einzelne Items. Methodisch ist das okay, solange wir Spearman oder Kendall verwenden. Die Funktion cor() braucht aber zwei numerics. 

#cor(as.numeric(df$ZUFR_GR), as.numeric(df$SOFF_GR), method = "spearman")
#cor(as.numeric(df$ZUFR_GR), as.numeric(df$SOFF_GR), method = "kendall")

#cor.test(as.numeric(df$ZUFR_GR), as.numeric(df$SOFF_GR), method = "spearman")
#cor.test(as.numeric(df$ZUFR_GR), as.numeric(df$SOFF_GR), method = "kendall")


#cor(df$ZUFR, df$SOFF, method = "pearson") #nicht geeignet
#cor(df$ZUFR, df$SOFF, method = "spearman")
cor(df$ZUFR, df$SOFF, method = "kendall")

#cor.test(df$ZUFR, df$SOFF, method = "spearman")
cor.test(df$ZUFR, df$SOFF, method = "kendall")




df %>% ggplot() + aes(x = ZUFR, y = SOFF) + geom_point(alpha = 0.5) + geom_smooth(method = lm, color = "black") + cowplot::theme_half_open() + labs(x = "Zufriedenheit", y = "Switch-off", title = "Zufriedenheit und Switch-off korrelieren negativ.")



# das hier bei Gruppen, jedoch für uns wahrscheinlich unwichtig: 

#df %>% ggplot() + aes(x = ZUFR_GR, y = SOFF_GR) + geom_jitter(alpha = 0.25, width = 0.2, height = 0.2) + geom_smooth(method = lm, color = "black") + cowplot::theme_half_open() + labs(x = "Zufriedenheit", y = "Switch-off", title = "robo_bed und robo_med korrelieren positiv.")



```
signifikant, kendall tau, 0.123. es gibt zusammenhang aber nur sehr schwach. deshalb keine aussagekraft. beim ausformulieren darauf achten wie die hypothesen formuliert waren.



```{r}
# Hypothese 2: Position der Arbeit, Switch-off

#cor.test(as.numeric(df$JOB_GR), as.numeric(df$SOFF_GR), method = "spearman")
#cor.test(as.numeric(df$JOB_GR), as.numeric(df$SOFF_GR), method = "kendall")


cor.test(as.numeric(df$JOB_GR), df$SOFF, method = "kendall")

df %>% ggplot() + aes(x = JOB_GR, y = SOFF) + geom_jitter(alpha = 0.25, width = 0.2, height = 0.2) + geom_smooth(method = lm, color = "black") + cowplot::theme_half_open() + labs(x = "Zufriedenheit", y = "Switch-off", title = "Zufriedenheit und Switch-off korrelieren negativ.")


```

wenn berichten dann werte ausgeben lassen.


```{r}
# Hypothese 3: Remote Working, Switch-off

#cor.test(as.numeric(df$MA_GR), as.numeric(df$SOFF_GR), method = "pearson")
#cor.test(as.numeric(df$MA_GR), as.numeric(df$SOFF_GR), method = "spearman")
#cor.test(as.numeric(df$MA_GR), as.numeric(df$SOFF_GR), method = "kendall")

cor.test(as.numeric(df$MA_GR), df$SOFF, method = "kendall")



df %>% ggplot() + aes(x = MA_O, y = SOFF) + geom_jitter(alpha = 0.25, width = 0.2, height = 0.2) + geom_smooth(method = lm, color = "black") + cowplot::theme_half_open() + labs(x = "Zufriedenheit", y = "Switch-off", title = "Zufriedenheit und Switch-off korrelieren negativ.")

  
  
```

wahrscheinlich nehmen wir die ganze zeit Kendall. pearson wahrscheinlich überhaupt nicht



```{r}
# Hypothese 4: Flexibilität, Arbeitszufriedenheit


#cor.test(as.numeric(df$FLEX_GR), as.numeric(df$ZUFR_GR), method = "spearman")
#cor.test(as.numeric(df$FLEX_GR), as.numeric(df$ZUFR_GR), method = "kendall")


#cor.test(df$FLEX, df$ZUFR, method = "spearman")
cor.test(df$FLEX, df$ZUFR, method = "kendall")




df %>% ggplot() + aes(x = FLEX, y = ZUFR) + geom_point(alpha = 0.5) + geom_smooth(method = lm, color = "black") + cowplot::theme_half_open() + labs(x = "Zufriedenheit", y = "Switch-off", title = "Zufriedenheit und Switch-off korrelieren negativ.")





```



```{r}

# Hypthese 5: Entfernung zur Arbeit, Switch-off

#cor.test(as.numeric(df$EN_GR), as.numeric(df$SOFF_GR), method = "spearman")
#cor.test(as.numeric(df$EN_GR), as.numeric(df$SOFF_GR), method = "kendall")

cor.test(as.numeric(df$EN_GR), df$SOFF, method = "kendall")



df %>% ggplot() + aes(x = EN_GR, y = SOFF) + geom_jitter(alpha = 0.25, width = 0.2, height = 0.2) + geom_smooth(method = lm, color = "black") + cowplot::theme_half_open() + labs(x = "Zufriedenheit", y = "Switch-off", title = "Zufriedenheit und Switch-off korrelieren negativ.")



```




# Unterschiede


```{r}

print("Hypothese 1: Mitarbeiter, die mit ihren Arbeitszeiten zufrieden sind, weisen einen besseren Switch-Off auf.")

#einfacher t-test
#t.test(as.numeric(df$SOFF_GR), mu=3.5)




# hier wichtig bestimmen, welche Gruppen wir vergleichen wollen, und ob eine Anova mehr Sinn macht

df_AZZ_GR_unzufrieden <- filter(df, AZZ_GR == "unzufrieden")
df_AZZ_GR_zufrieden <- filter(df, AZZ_GR == "zufrieden")
df_AZZ_GR_sehrzufrieden <- filter(df, AZZ_GR == "sehr zufrieden")


#JRH: Das hier geht:
#t.test(as.numeric(df_AZZ_GR_unzufrieden$SOFF_GR), as.numeric(df_AZZ_GR_sehrzufrieden$SOFF_GR))


#U-Test (brauchen wir wahrscheinlich nicht)
#df_AZZ_GR_unzufrieden$SOFF_GR <- as.numeric(df_AZZ_GR_unzufrieden$SOFF_GR)
#df_AZZ_GR_sehrzufrieden$SOFF_GR <- as.numeric(df_AZZ_GR_sehrzufrieden$SOFF_GR)

#wilcox.test(df_AZZ_GR_unzufrieden$SOFF_GR, df_AZZ_GR_sehrzufrieden$SOFF_GR)



#t.test(df_AZZ_GR_unzufrieden$SOFF, df_AZZ_GR_sehrzufrieden$SOFF)
#t.test(df_AZZ_GR_unzufrieden$SOFF, df_AZZ_GR_zufrieden$SOFF)

#t.test(df_AZZ_GR_zufrieden$SOFF, df_AZZ_GR_unzufrieden$SOFF)
#t.test(df_AZZ_GR_sehrzufrieden$SOFF, df_AZZ_GR_unzufrieden$SOFF)







df %>% ANOVA(dep = "SOFF", factors = c("AZZ_GR"))

             
             
print("In der Stichprobe fällt Menschen, die mit ihren Arbeitszeiten zufrieden sind, der Switch Off leichter als Menschen, die mit ihren Arbeitszeiten unzufrieden sind. Dieser Unterschied ist signifikant. (t(41.54 = -2.407, P < .05) und liegt mit 95% Sicherheit zwischen 0.05 und 0.57 Punkten einer 6-stufigen Skala.")

```





```{r}
print("Hypothese 2: Mitarbeiter mit geringerer Arbeitszeit (bis zu 29 Std. pro Woche) und geringerer Arbeitsintensität (keine Überstunden) weisen einen besseren Switch-Off auf.")





df %>% ANOVA(dep = "SOFF", factors = c("AZ_GR", "AI_GR"))
             
             
             #effectSize = "partEta", 
             #postHoc = SOFF ~ AZ_GR,
             #emMeans = ~ AZ_GR, 
             #emmPlots = TRUE)
  

#df$SOFF_GR <- as.numeric(df$SOFF_GR)

#df %>% 
  #ANOVA(dep = "SOFF_GR", factors = c("AZ_GR", "AI_GR"))






```







```{r}

print("Hypothese 3: Mitarbeiter, die länger (über den Mediansplit der Arbeitsjahre) in der aktuellen Jobposition beschäftigt sind, weisen einen besseren Switch-Off auf.") 

#hilfestellung
# t.test(filter(data,gender == "männlich")$KUT, filter(data, gender == "weiblich")$KUT)


#### das hier noch gucken wie das geht ->      

#t.test(filter(df, AD_GR == "0:1")$SOFF, filter(df,AD_GR == "2:5")$SOFF)





```



```{r}

print("Hypothese 4: Mitarbeiter, die den Großteil der Woche (drei oder mehr Tage) nicht am Arbeitsplatz arbeiten, weisen einen schlechteren Switch-Off auf.")


### funktioniert noch nicht


#df_MA_GR_geringerAnteil <- filter(df, MA_GR == "geringer Anteil der Woche (≤ 2 Tage/Woche)")
#df_MA_GR_Grossteil <- filter(df, MA_GR == "Großteil der Woche (≥ 3 Tage/Woche)")


#   t.test(filter(df, MA_GR == "geringer Anteil der Woche (≤ 2 Tage/Woche)")$SOFF, filter(df,MA_GR == "Großteil der Woche (≥ 3 Tage/Woche)")$SOFF)



```

```{r}

print("Hypothese 5: Mitarbeiter, die flexibel in ihrem Job sind, weisen einen besseren Switch-Off und eine höhere Arbeitszufriedenheit auf.")
# One way Manova


#ist das selbe wie unten
#obwohl wir hier eine manova rechnen, benutzen wir mancova, da in dieser Funktion der covs Wert (Covariate) standardmäßig auf NULL steht
#df %>% mancova(dep = c("SOFF", "ZUFR"), factors = "FLEX")

mancova(df, deps = c("SOFF", "ZUFR"), factors = "FLEX")





```


